@using EmployeeManagement.Models
@model Employee

@{
    ViewBag.Title = "Details Of Employee";
}

<div class="row">
    <div class="col-md-8 offset-md-2">

        <table class="table">
            <thead>
                <tr class="text-center">
                    <th>@Html.DisplayNameFor(model => model.EmpName)</th>
                    <th>@Html.DisplayNameFor(model => model.Designation)</th>
                    <th>@Html.DisplayNameFor(model => model.Department)</th>
                    <th>@Html.DisplayNameFor(model => model.TotalSalary)</th>
                </tr>
            </thead>
            @foreach (var employee in ViewBag.Employees)
            {
                <tr style="text-align:center;" id="row_@employee.Id">
                    <td class="align-middle">@employee.EmpName</td>
                    <td class="align-middle">@employee.Designation</td>
                    <td class="align-middle">@employee.Department.Name</td>
                    <td class="align-middle">@employee.TotalSalary</td>
                    <td class="align-middle">
                        <a class="btn btn-outline-primary" asp-action="Edit" asp-route-id="@employee.Id"><i class="bi bi-pencil-square"></i>Edit </a> |
                        <a class="btn btn-danger text-white" onclick="ConfirmDelete(@employee.Id)"><i class="bi bi-trash"></i>Delete </a>
                    </td>
                </tr>
            }
        </table>
    </div>
</div>

<a class="btn btn-outline-primary" asp-action="Index"><i class="bi bi-pencil-square"></i>Add Employee</a>

<div class="modal fade" id="myModal">
    <div class="modal-dialog">
        <div class="modal-content">


            <div class="modal-header">
                <a href="#" class="close" data-dismiss="modal">X</a>
                <h3 class="modal-title">Delete Employee</h3>
            </div>
            <div class="modal-body">
                <h4>Are you sure ? You want to delete this. </h4>

                <div style="text-align:center;display:none" id="loaderDiv">

                    <img src="~/img/loading.gif" style="height:200px;width:200px" />
                </div>

            </div>
            <div class="modal-footer">
                <a href="#" class="btn btn-default" data-dismiss="modal">Cancel</a>
                <a class="btn btn-success" onclick="DeleteEmployee()">Confirm</a>
            </div>

        </div>

    </div>

</div>
<input type="hidden" id="hiddenEmployeeId" />

<script>

    var ConfirmDelete = function (EmployeeId) {

        $("#hiddenEmployeeId").val(EmployeeId);
        $("#myModal").modal('show');

    }

    var DeleteEmployee = function () {

        $("#loaderDiv").show();

        var empId = $("#hiddenEmployeeId").val();

        $.ajax({

            type: "DELETE",
            url: "/Home/Delete",
            data: { EmployeeId: empId },
            success: function (result) {
                $("#loaderDiv").hide();
                $("#myModal").modal("hide");
                $("#row_" + empId).remove();

            }

        })

    }
</script>

